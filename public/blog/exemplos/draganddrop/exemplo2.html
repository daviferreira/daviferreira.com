<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Davi Ferreira Blog - Interface Drag and Drop - exemplo com cookies</title>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="interface.js"></script>
<script type="text/javascript" src="jquery.cookie.js"></script>
<link href="exemplo.css" rel="stylesheet" type="text/css" media="screen" />
<style type="text/css">
div#drop-esquerda {
	width: 40%;
	float: left;
	margin: 10px;
}
div#drop-direita {
	width: 40%;
	float: left;
	margin: 10px;
}
div.recebeDrag {
	min-height: 50px;
}
div.itemDrag {
	margin: 7px;
	border: 1px solid #ccc;
	padding: 7px;
}
ul {
	list-style: none;
}
ul li {
	border-bottom: 1px dotted silver;
	padding: 4px;
}
h2 {
	cursor: move !important;
	background-color: #FF3300;
	color: #fff;
	padding: 3px;
}
.dragAjuda {
	border: 3px dashed #0066CC;
	width: auto !important;
}
.dragAtivo {
	background-color: #f7f7f7;
}
.dragHover {
	background-color: #F0F1FF;
}
</style>
</head>
<body>

<!-- debug -->

<div style="background-color: #f7f7f7;padding:10px;border-bottom:1px solid #333;">
	<p><strong>Serialize</strong> (posição dos elementos nos divs.recebeDrag)</p>
    <p>Esquerda: <input type="text" id="ser-e" size="100" /></p>
    <p>Direita: <input type="text" id="ser-d" size="100" /></p>
</div>
<!-- fim debug -->

<div id="voltar" style="text-align:center;border: 1px dotted silver; padding: 4px;"><a href="http://www.daviferreira.com/blog/2007/08/12/interface-drag-and-drop-com-jquery.html">Voltar para o post deste exemplo.</a><br /><a href="http://www.daviferreira.com/blog/2007/08/12/interface-drag-and-drop-com-jquery.html">http://www.daviferreira.com/blog/2007/08/12/interface-drag-and-drop-com-jquery.html</a></div>

<div id="drop-esquerda" class="recebeDrag">
  <div id="aassinados" class="itemDrag">
    <h2> abaixo-assinados mais aderidos</h2>
    <ul>
      <li>
        <p><a href="http://beta.democracia.com.br/aassinado/ver.php?codigo=1">Um milhão de hectares ou um milhão de reais? <small>7 assinaturas</small></a></p>
      </li>

      <li>
        <p><a href="http://beta.democracia.com.br/aassinado/ver.php?codigo=2">Majoramento da pena de políticos corruptos <small>6 assinaturas</small></a></p>
      </li>
      <li>
        <p><a href="http://beta.democracia.com.br/aassinado/ver.php?codigo=6">Pena de Morte para Politicos Corruptos <small>4 assinaturas</small></a></p>
      </li>
    </ul>

  </div>
  <!-- / box abaxo-assinados -->
  <div id="debates" class="itemDrag">
    <h2>debates mais polêmicos</h2>
    <ul>
      <li>
        <p><a href="http://beta.democracia.com.br/debate/ver.php?codigo=2">Majoramento da pena de políticos corruptos<small>8 comentários - 4 apoiaram </small></a></p>

      </li>
      <li>
        <p><a href="http://beta.democracia.com.br/debate/ver.php?codigo=4">Vamos apagar o apagão aéreo?<small>7 comentários - 2 apoiaram </small></a></p>
      </li>
      <li>
        <p><a href="http://beta.democracia.com.br/debate/ver.php?codigo=1">Um milhão de hectares ou um milhão de reais?<small>5 comentários - 2 apoiaram </small></a></p>
      </li>

    </ul>
  </div>
  <!-- / box debates -->
</div>
<!-- / box drop-esquerda -->
<div id="drop-direita" class="recebeDrag">
  <div id="perfis" class="itemDrag">
    <h2>perfis cadastrados</h2>
    <ul>
      <li>

        <p><a href="http://beta.democracia.com.br/perfil/ver.php?codigo=37">Bruno Magrani de Souza<small>Rio de Janeiro - Rio de Janeiro
          <!-- -  anos | Empresário -->
          </small></a></p>
      </li>
      <li>
        <p><a href="http://beta.democracia.com.br/perfil/ver.php?codigo=36">Armando Silva<small>Niter&oacute;i - Rio de Janeiro
          <!-- -  anos | Empresário -->
          </small></a></p>

      </li>
      <li>
        <p><a href="http://beta.democracia.com.br/perfil/ver.php?codigo=35">Bruna<small>Rio de Janeiro - Rio de Janeiro
          <!-- -  anos | Empresário -->
          </small></a></p>
      </li>
    </ul>
  </div>
  <!-- / box perfil cadastrado -->

  <div id="blog" class="itemDrag">
    <h2>democracia blog</h2>
    <ul>
      <li>
        <p><a href="http://www.democracia.com.br/blog/?p=34" rel="external">Esboçando a inclusão digital... <small>06/08/2007 13:47</small></a></p>
      </li>
      <li>

        <p><a href="http://www.democracia.com.br/blog/?p=33" rel="external">Bate-rebate entre "Cansamos" e "Cansei" é mais do mesmo cansaço <small>31/07/2007 18:05</small></a></p>
      </li>
      <li>
        <p><a href="http://www.democracia.com.br/blog/?p=22" rel="external">Quando a estética tropeça na ética... e na dor do luto <small>20/07/2007 11:00</small></a></p>
      </li>
    </ul>
  </div>

  <!-- / box blog -->
</div>
<!-- / box drop-direita -->



<script type="text/javascript">
$(document).ready(
	function () {
		
		// verifica se cookies existem
		if ($.cookie('coluna1') != null) {
			//alert($.cookie('coluna1'));
			// formata string do cookie
			var coluna1 = $.cookie('coluna1').replace(/drop-esquerda\[\]=/g, '');
			var coluna1 = coluna1.split('&');
			//alert(coluna1);
			var div_id = '';
			for (var x = 0; x <= coluna1.length; x++) {
				div_id = coluna1[x];
				$('#drop-esquerda').append($('#'+div_id)); 
			}
		}
		if ($.cookie('coluna2') != null) {
			var coluna2 = $.cookie('coluna2').replace(/drop-direita\[\]=/g, '');
			var coluna2 = coluna2.split('&');
			//alert(coluna2);
			var div_id = '';
			for (var x = 0; x <= coluna2.length; x++) {
				div_id = coluna2[x];
				$('#drop-direita').append($('#'+div_id)); 
			}
		}		
		
		
		
		
		$('div.recebeDrag').Sortable(
			{
				accept			: 'itemDrag',
				helperclass		: 'dragAjuda',
				activeclass 	: 'dragAtivo',
				hoverclass 		: 'dragHover',
				handle			: 'h2',
				opacity			: 0.7,
				onChange 		: function()
				{	    			 
					serialEsq = $.SortSerialize('drop-esquerda');
					serialDir = $.SortSerialize('drop-direita');
					$('#ser-e').val(serialEsq.hash);
					$('#ser-d').val(serialDir.hash);
					// salva cookie com posicionamento
					$.cookie('coluna1', serialEsq.hash, {expires: 7});
					$.cookie('coluna2', serialDir.hash, {expires: 7});
					//alert($.cookie('coluna1'));
				},
				onStart : function()
				{
					$.iAutoscroller.start(this, document.getElementsByTagName('body'));
				},
				onStop : function()
				{
					$.iAutoscroller.stop();
				}
			}
		);
		
	}
);
</script>
</body>
</html>
